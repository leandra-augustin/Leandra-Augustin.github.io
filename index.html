<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Portfólio Profissional — Rita Leandra Augustin</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600&display=swap" rel="stylesheet">

<!-- Analytics (Plausible) — injeta automaticamente usando o domínio atual -->
<script>
(function(){
  var d=document,s=d.createElement('script');
  s.defer=true; s.setAttribute('data-domain', location.hostname);
  s.src='https://plausible.io/js/script.js';
  d.head.appendChild(s);
  window.track=function(name){try{window.plausible&&window.plausible(name);}catch(e){}}
})();
</script>

<style>
:root{ --bg:#0e0f13; --card:#151821; --text:#e7e9ee; --muted:#9aa3b2; --brand:#7c3aed; --wmOpacity:.40; }
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:"Oswald",sans-serif;letter-spacing:.3px}
a{color:inherit;text-decoration:none}
.wrap{max-width:1200px;margin:auto;padding:24px}

/* Header */
header.site-header{background:linear-gradient(180deg, rgba(124,58,237,.12), transparent 60%);border-bottom:1px solid rgba(124,58,237,.15);position:sticky;top:0;z-index:10;backdrop-filter:saturate(140%) blur(6px)}
.header-block{display:grid;grid-template-columns:auto 1fr;align-items:center;gap:16px;padding:14px 24px 16px}
header .photo{width:84px;height:84px;border-radius:50%;overflow:hidden;border:1px solid rgba(255,255,255,.12);box-shadow:0 8px 24px rgba(0,0,0,.25)}
header .photo img{width:100%;height:100%;object-fit:cover;display:block}
header .name{margin:0 0 4px 0;font-size:28px;font-weight:600;letter-spacing:.5px;line-height:1.1}
header .role{margin:0;color:#d8dff0;font-size:16px;line-height:1.25}
header .tagline{margin:6px 0 10px 0;color:#cfd6e6;font-size:14px;letter-spacing:.3px}
header .contacts{margin:0;padding:10px 0 0 0;color:var(--muted);display:flex;gap:14px;flex-wrap:wrap;font-size:14px;border-top:1px solid rgba(255,255,255,.08)}
header .contacts a:hover{text-decoration:underline}
.dot{color:var(--muted)}
@media(max-width:720px){.header-block{gap:12px}header .photo{width:74px;height:74px}header .name{font-size:24px}}

/* Seções */
section.topic{margin:48px 0 12px}
.topic h2{font-size:18px;font-weight:600;margin:0 0 14px;color:#cfd6e6;letter-spacing:.4px}
details.group-desc{margin:8px 0 16px;background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px}
details.group-desc[open]{border-color:rgba(255,255,255,.14)}
details.group-desc summary{cursor:pointer;list-style:none;padding:10px 14px;user-select:none;display:flex;align-items:center;gap:10px;color:#cfd6e6}
details.group-desc summary::-webkit-details-marker{display:none}
.caret{width:10px;height:10px;border-right:2px solid #cfd6e6;border-bottom:2px solid #cfd6e6;transform:rotate(-45deg);transition:transform .25s ease;margin-left:2px}
details.group-desc[open] .caret{transform:rotate(45deg)}
.desc-body{padding:0 14px 12px 42px;color:var(--muted);font-size:14px}

/* Tiras de thumbs */
.strip{display:flex;gap:14px;overflow-x:auto;padding:14px;background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:14px;scroll-snap-type:x proximity}
.thumb{position:relative;flex:0 0 auto;scroll-snap-align:start;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,.08);max-width:260px}
.thumb a{display:inline-block;position:relative;line-height:0}
.thumb img{display:block;height:220px;width:auto;filter:blur(0.2px) saturate(0.98) contrast(1)}
.thumb .hint{position:absolute;right:8px;bottom:8px;font-size:12px;color:#cdd3e0;background:rgba(14,15,19,.6);padding:4px 6px;border-radius:8px}
.thumb figcaption{font-size:12px;color:var(--muted);padding:8px 10px 10px;max-width:260px}

/* Máscaras (visual) */
.mask{position:absolute;border-radius:6px;backdrop-filter: blur(8px) brightness(.95);-webkit-backdrop-filter: blur(8px) brightness(.95);box-shadow:0 0 0 1px rgba(255,255,255,.06) inset}
.mask::after{content:"redigido";position:absolute;right:4px;bottom:2px;font-size:10px;letter-spacing:.2px;color:rgba(255,255,255,.75);padding:2px 6px;border-radius:6px;background:rgba(0,0,0,.25)}
#lb-masks{position:absolute;inset:0}

/* Marca d'água (thumbs) */
.thumb a[data-wm]::after{content:attr(data-wm);position:absolute;inset:0;display:flex;align-items:center;justify-content:center;transform:rotate(-24deg);font-size:26px;font-weight:700;letter-spacing:.15em;color:rgba(0,0,0,var(--wmOpacity));text-shadow:0 1px 0 rgba(255,255,255,.25);text-transform:uppercase;pointer-events:none}

/* Lightbox */
.lightbox{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(10,12,16,.85);opacity:0;pointer-events:none;z-index:999;padding:24px;transition:opacity .25s ease}
.lightbox.open{opacity:1;pointer-events:auto}
.lb-viewport{max-width:96vw;max-height:82vh;overflow:auto;border-radius:12px}
.lb-fig{position:relative;display:block}
.lb-fig img{display:block;width:100%;height:auto;border-radius:12px;border:1px solid rgba(255,255,255,.12)}
.lightbox .close{position:absolute;top:18px;right:22px;font-size:14px;color:#e6e9f2;background:rgba(255,255,255,.08);padding:8px 10px;border-radius:10px}

/* Toolbar: oculta para visitantes; visível só em .admin */
.lb-toolbar{position:absolute;top:18px;left:22px;display:none;gap:8px;flex-wrap:wrap}
.admin .lb-toolbar{display:flex;}
.lb-toolbar button,.lb-toolbar input[type="range"]{background:rgba(0,0,0,.45);color:#fff;border:1px solid rgba(255,255,255,.2);border-radius:10px;padding:6px 10px;font-size:12px}
.lb-toolbar .range-wrap{display:flex;align-items:center;gap:6px;background:rgba(0,0,0,.45);padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.2);color:#fff}
.sel-rect{position:absolute;border:1px dashed rgba(255,255,255,.7);background:rgba(124,58,237,.18);pointer-events:none;border-radius:6px;z-index:2}

.lightbox .panel{position:absolute;left:24px;right:24px;bottom:24px;background:rgba(0,0,0,.45);backdrop-filter:blur(6px) saturate(120%);color:#eef1f7;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.15)}
.lightbox .panel h3{margin:0 0 4px 0;font-size:14px;font-weight:600}
.lightbox .panel p{margin:0;font-size:13px;line-height:1.35;color:#d6dbe6}

/* Watermark layer na lightbox */
.wm-layer{position:absolute;inset:0;pointer-events:none;display:flex;align-items:center;justify-content:center;transform:rotate(-24deg);font-size:6vw;min-font-size:28px;letter-spacing:.18em;font-weight:800;color:rgba(0,0,0,var(--wmOpacity));text-shadow:0 1px 0 rgba(255,255,255,.28);text-transform:uppercase}

/* Footer */
footer.site-footer{margin-top:36px;padding:24px;color:var(--muted);border-top:1px solid rgba(255,255,255,.06);text-align:center;letter-spacing:.4px}

/* Intro + espaçamentos (overrides) */
.intro{
  margin:24px 0 36px;
  padding:0;
  background:none;
  border:0;
  color:var(--muted);
  font-size:15px;
  line-height:1.55;
}
.intro p{margin:0 0 6px 0}
.topic{margin:48px 0 12px}
.topic + .topic{margin-top:56px}
details.group-desc{margin:8px 0 16px}
.strip{gap:14px;padding:14px}
@media(max-width:720px){
  .intro{margin:20px 0 28px}
  .topic{margin:36px 0 10px}
  .topic + .topic{margin-top:42px}
  details.group-desc{margin:8px 0 14px}
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="site-header">
  <div class="wrap header-block">
    <div class="photo"><img src="img/foto.jpeg" alt="Foto — Rita Leandra Augustin" onerror="this.style.display='none'"></div>
    <div class="id">
      <h1 class="name">Rita Leandra Augustin</h1>
      <p class="role">Especialista em Agilidade, Liderança e Transformação Organizacional</p>
      <p class="tagline">Portfólio Profissional</p>
      <div class="contacts">
        <a href="mailto:rita.augustin@gmail.com">rita.augustin@gmail.com</a><span class="dot">•</span>
        <a href="tel:+5551985077705">+55 (51) 98507-7705</a><span class="dot">•</span>
        <a href="https://www.linkedin.com/in/rita-leandra-augustin" target="_blank" rel="noopener">LinkedIn</a>
      </div>
    </div>
  </div>
</header>

<!-- INTRO (fora de cartão, mais perto do cabeçalho) -->
<div class="wrap intro" role="note">
  <p>Este portfólio apresenta exemplos de projetos e materiais desenvolvidos em contextos reais de transformação organizacional. Algumas informações e imagens foram adaptadas e/ou redigidas para fins de demonstração profissional.</p>
  <p>Para visualizar detalhes, clique nas miniaturas para abrir em tela cheia.</p>
</div>

<!-- CONTROLES (apenas para admin; visitantes não veem nada) -->
<section class="wrap controls admin-only" style="display:none;">
  <div class="right">
    <div class="range"><span>Marca d'água</span><input type="checkbox" id="wm-toggle" checked></div>
    <div class="range"><span>Opacidade</span><input type="range" id="wm-range" min="0" max="100" value="40"><span id="wm-val">40%</span></div>
  </div>
</section>

<!-- CONTEÚDO PRINCIPAL -->
<main class="wrap" aria-label="Portfólio — Imagens">

  <!-- MÉTODOS -->
  <section class="topic" id="metodos">
    <h2>Guia de Métodos e Práticas Ágeis</h2>
    <details class="group-desc" open>
      <summary><span class="caret" aria-hidden="true"></span> Ver descrição do grupo</summary>
      <div class="desc-body">
        Coleção de materiais desenvolvidos para apoiar lideranças e equipes na adoção consciente de práticas ágeis, oferecendo orientação sobre frameworks, cadências e critérios para aplicação efetiva de Scrum e Kanban em diferentes contextos organizacionais.
      </div>
    </details>
    <div class="strip">
      <figure class="thumb">
        <a href="#" data-src="img/metodo_0.png" data-title="Guia ilustrativo de cadências ágeis" data-desc="Material visual criado para esclarecer as principais cadências aplicadas nos métodos Scrum e Kanban, facilitando a compreensão e a adoção pelas equipes. Desenvolvido como parte do conjunto de conteúdos de capacitação interna.">
          <img src="img/metodo_0.png" alt="Guia ilustrativo de cadências ágeis"><span class="hint">Expandir</span>
        </a>
        <figcaption>Guia ilustrativo das cadências aplicadas nos métodos Scrum e Kanban.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/metodo_1.png" data-title="Primeiros passos para aplicação do Scrum" data-desc="Documento elaborado para orientar as equipes nos estágios iniciais de adoção do Scrum, descrevendo propósitos, papéis, cerimônias e práticas essenciais para o início da jornada ágil.">
          <img src="img/metodo_1.png" alt="Primeiros passos para aplicação do Scrum"><span class="hint">Expandir</span>
        </a>
        <figcaption>Guia introdutório sobre os primeiros passos para aplicar Scrum com clareza e propósito.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/metodo_2.png" data-title="Critérios para escolha do método mais adequado" data-desc="Referência construída para apoiar líderes e squads na escolha consciente entre frameworks e práticas, considerando o objetivo do time, o nível de maturidade e o tipo de entrega. Inclui recomendações práticas para transição e evolução de métodos.">
          <img src="img/metodo_2.png" alt="Critérios para escolha do método mais adequado"><span class="hint">Expandir</span>
        </a>
        <figcaption>Critérios e orientações para escolher o método ágil mais adequado ao contexto do time.</figcaption>
      </figure>
    </div>
  </section>

  <!-- OKRs -->
  <section class="topic" id="okrs">
    <h2>Workshops e Documentações de OKRs Estratégicos e Táticos</h2>
    <details class="group-desc" open>
      <summary><span class="caret" aria-hidden="true"></span> Ver descrição do grupo</summary>
      <div class="desc-body">
        Conjunto de materiais e registros visuais desenvolvidos para orientar a definição, disseminação e acompanhamento dos OKRs em diferentes níveis da organização. Os conteúdos refletem a aplicação prática da metodologia, desde a construção colaborativa com lideranças até a sustentação por meio de documentação e painéis de governança.
      </div>
    </details>
    <div class="strip">
      <figure class="thumb">
        <a href="#" data-src="img/okrs_estrategico_1.png" data-title="Workshop de definição dos OKRs Estratégicos" data-desc="Registro visual do workshop conduzido com as lideranças de produto, tecnologia e design para a definição dos OKRs estratégicos da organização. O processo envolveu alinhamento de propósito, análise SWOT e identificação de direcionadores de valor.">
          <img src="img/okrs_estrategico_1.png" alt="Workshop de definição dos OKRs Estratégicos"><span class="hint">Expandir</span>
        </a>
        <figcaption>Workshop colaborativo com lideranças para definição dos OKRs estratégicos.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/okrs_estrategico_2.png" data-title="Guia de estruturação de OKRs Estratégicos" data-desc="Documento produzido no Confluence com orientações sobre como estruturar OKRs estratégicos, incluindo exemplos, critérios de qualidade e boas práticas para definição de objetivos claros e mensuráveis.">
          <img src="img/okrs_estrategico_2.png" alt="Guia de estruturação de OKRs Estratégicos"><span class="hint">Expandir</span>
        </a>
        <figcaption>Guia de referência para estruturação e boas práticas de OKRs estratégicos.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/okrs_tatico_1.png" data-title="Workshops de construção de OKRs Táticos" data-desc="Workshops realizados com as tribos e squads para desdobramento dos OKRs estratégicos em metas táticas, fortalecendo o alinhamento entre o nível estratégico e o operacional.">
          <img src="img/okrs_tatico_1.png" alt="Workshops de construção de OKRs Táticos"><span class="hint">Expandir</span>
        </a>
        <figcaption>Construção colaborativa de OKRs táticos conectados aos objetivos estratégicos.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/okrs_tatico_2.png" data-title="Guia de Estruturação de OKRs Táticos" data-desc="Documento explicativo com fundamentos, estrutura e critérios de definição de OKRs táticos, utilizado para promover consistência entre os times e orientar a elaboração dos resultados-chave.">
          <img src="img/okrs_tatico_2.png" alt="Guia de Estruturação de OKRs Táticos"><span class="hint">Expandir</span>
        </a>
        <figcaption>Guia de apoio à elaboração e consolidação dos OKRs táticos.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/okrs_jira_1.png" data-title="Guia prático: criação de OKRs no Jira" data-desc="Passo a passo para registrar OKRs no Jira, conectando objetivos e resultados-chave a iniciativas de produto e tecnologia.">
          <img src="img/okrs_jira_1.png" alt="Guia prático: criação de OKRs no Jira"><span class="hint">Expandir</span>
        </a>
        <figcaption>Guia prático para criação e registro de OKRs no Jira.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/okrs_jira_2.png" data-title="Estrutura e rastreabilidade de OKRs no Jira" data-desc="Documento explicativo sobre a estrutura de rastreabilidade entre objetivos, resultados-chave e backlog no Jira, reforçando a conexão entre estratégia e execução.">
          <img src="img/okrs_jira_2.png" alt="Estrutura e rastreabilidade de OKRs no Jira"><span class="hint">Expandir</span>
        </a>
        <figcaption>Estrutura de rastreabilidade dos OKRs no Jira: conexão entre estratégia e execução.</figcaption>
      </figure>
    </div>
  </section>

  <!-- FLUXO -->
  <section class="topic" id="fluxo">
    <h2>Modelo de Fluxo de Trabalho e Governança Escalável</h2>
    <details class="group-desc" open>
      <summary><span class="caret" aria-hidden="true"></span> Ver descrição do grupo</summary>
      <div class="desc-body">
        Estrutura metodológica criada para unificar a forma de trabalho entre áreas de produto, tecnologia e negócios, promovendo alinhamento, previsibilidade e fluidez organizacional. Os documentos consolidam políticas, papéis e fluxos que sustentaram a governança escalável da companhia.
      </div>
    </details>
    <div class="strip">
      <figure class="thumb">
        <a href="#" data-src="img/doc_fluxo_1.png" data-title="Fluxo de Valor — Conceito e Aplicação" data-desc="Documento que apresenta o conceito de fluxo de valor e sua aplicação prática na companhia, conectando entregas de produto a objetivos estratégicos e resultados de negócio.">
          <img src="img/doc_fluxo_1.png" alt="Fluxo de Valor — Conceito e Aplicação"><span class="hint">Expandir</span>
        </a>
        <figcaption>Conceito e aplicação do fluxo de valor, conectando estratégia e operação.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/doc_fluxo_2.png" data-title="Workflow de Entrega — Políticas e Critérios" data-desc="Definição das políticas, etapas e critérios de transição que compõem o workflow de entrega, garantindo rastreabilidade e consistência nos processos entre squads.">
          <img src="img/doc_fluxo_2.png" alt="Workflow de Entrega — Políticas e Critérios"><span class="hint">Expandir</span>
        </a>
        <figcaption>Workflow de entrega: políticas, critérios e transições padronizadas.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/doc_fluxo_3.png" data-title="Workflow de Produtos — Responsabilidades e Qualidade" data-desc="Mapa de responsabilidades e critérios de qualidade aplicados no ciclo de desenvolvimento de produtos, reforçando a colaboração entre times de produto, engenharia e design.">
          <img src="img/doc_fluxo_3.png" alt="Workflow de Produtos — Responsabilidades e Qualidade"><span class="hint">Expandir</span>
        </a>
        <figcaption>Workflow de produtos, papéis e critérios de qualidade.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/doc_fluxo_4.png" data-title="Workflow de Refinamento — Etapas e Critérios" data-desc="Documento que detalha o processo de refinamento de demandas, priorização e preparação para desenvolvimento, fortalecendo a previsibilidade e o fluxo de entrega contínuo.">
          <img src="img/doc_fluxo_4.png" alt="Workflow de Refinamento — Etapas e Critérios"><span class="hint">Expandir</span>
        </a>
        <figcaption>Workflow de refinamento e critérios de preparo para desenvolvimento.</figcaption>
      </figure>
      <figure class="thumb">
        <a href="#" data-src="img/doc_fluxo_5.png" data-title="Visão Consolidada do Fluxo Unificado" data-desc="Representação visual do fluxo unificado entre áreas e times, com foco em transparência, previsibilidade e governança. Modelo criado para servir de referência corporativa e apoiar a evolução da maturidade organizacional." data-mask-preset="tr-wide">
          <img src="img/doc_fluxo_5.png" alt="Visão Consolidada do Fluxo Unificado"><span class="hint">Expandir</span>
        </a>
        <figcaption>Fluxo unificado entre áreas e squads, com visibilidade e governança integrada.</figcaption>
      </figure>
    </div>
  </section>

  <!-- COE -->
  <section class="topic" id="coe">
    <h2>Centro de Excelência em Agilidade (COE Agile Team)</h2>
    <details class="group-desc" open>
      <summary><span class="caret" aria-hidden="true"></span> Ver descrição do grupo</summary>
      <div class="desc-body">
        Estrutura criada para fortalecer a governança da agilidade na organização, atuando como centro de referência para práticas, métricas e desenvolvimento de lideranças. O COE consolidou pilares de cultura, aprendizado e melhoria contínua, conectando estratégia e operação através de iniciativas de capacitação, coaching e gestão do conhecimento.
      </div>
    </details>
    <div class="strip">
      <figure class="thumb">
        <a href="#" data-src="img/coe_agile_team.png" data-title="Mapa de Serviços do COE de Agilidade" data-desc="Representação visual dos serviços e pilares estruturados no Centro de Excelência em Agilidade. O modelo definiu as frentes de atuação — coaching, capacitação, métricas, governança e inovação — estabelecendo uma base sólida para a consolidação da cultura ágil e o desenvolvimento contínuo das lideranças." data-mask-preset="tr-wide">
          <img src="img/coe_agile_team.png" alt="Mapa de Serviços do COE de Agilidade"><span class="hint">Expandir</span>
        </a>
        <figcaption>Mapa visual dos serviços e pilares que sustentaram o Centro de Excelência em Agilidade.</figcaption>
      </figure>
    </div>
  </section>

</main>

<footer class="site-footer">
  © <span id="y"></span> Rita Leandra Augustin — Portfólio Profissional
  <br>
  <small>
    Este portfólio mostra exemplos selecionados com marca d’água e áreas redigidas para preservar confidencialidade.
    Sinta-se à vontade para usar ideias ou trechos de texto — evite apenas reproduzir informações sensíveis ou identificar terceiros.
  </small>
</footer>

<!-- LIGHTBOX + EDITOR -->
<div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="Visualização de imagem">
  <button class="close" aria-label="Fechar (Esc)" type="button">Fechar ✕</button>
  <div class="lb-toolbar" id="lb-toolbar">
    <button id="lb-edit-toggle" type="button" title="Ativar/Desativar edição de máscaras">Editar máscaras</button>
    <button id="lb-add" type="button" title="Adicionar nova máscara">+ Adicionar</button>
    <button id="lb-undo" type="button" title="Remover última máscara">↩ Remover última</button>
    <button id="lb-clear" type="button" title="Limpar todas as máscaras">🗑 Limpar todas</button>
    <button id="lb-copy" type="button" title="Copiar definições de máscaras">📋 Copiar máscaras</button>
    <button id="lb-export" type="button" title="Exportar todas as máscaras (JSON)">⬇ Exportar</button>
    <label class="range-wrap" title="Importar máscaras (JSON)">
      <span>⬆ Importar</span>
      <input type="file" id="lb-import" accept="application/json" style="background:transparent;border:none;padding:0;cursor:pointer">
    </label>
    <div class="range-wrap"><label for="lb-zoom">Zoom</label><input type="range" id="lb-zoom" min="50" max="200" value="100"><span id="lb-zoom-val">100%</span></div>
  </div>
  <div class="lb-viewport">
    <div class="lb-fig" id="lb-fig" style="width:auto;">
      <img src="" alt="" id="lb-img">
      <div id="lb-masks"></div>
      <div class="wm-layer" id="lb-wm">Portfolio</div>
    </div>
  </div>
  <div class="panel" aria-live="polite" aria-atomic="true">
    <h3 id="lb-title"></h3><p id="lb-desc"></p>
  </div>
</div>

<script>
/* Utils */
const $=(q,ctx=document)=>ctx.querySelector(q), $$=(q,ctx=document)=>Array.from(ctx.querySelectorAll(q));
$('#y').textContent=new Date().getFullYear();

/* --------- ADMIN MODE --------- */
const ADMIN=(()=>{
  const q=location.search+location.hash;
  const hasFlag=/(^|[?#])admin(=1|=true|$)/i.test(q);
  const isLocal=['localhost','127.0.0.1'].includes(location.hostname);
  return hasFlag||isLocal;
})();
if(ADMIN){
  document.documentElement.classList.add('admin');
  const adminOnly=$('.admin-only'); if(adminOnly) adminOnly.style.display='flex';
}

/* --------- Watermark --------- */
const WM_TEXT="Portfolio";
const wmToggle=$('#wm-toggle'), wmRange=$('#wm-range'), wmVal=$('#wm-val');
function forceVisitorWM(){
  $$('.thumb a[data-src]').forEach(a=>a.setAttribute('data-wm',WM_TEXT));
  const lbwm=$('#lb-wm'); if(lbwm){ lbwm.style.display='flex'; lbwm.textContent=WM_TEXT; }
  document.documentElement.style.setProperty('--wmOpacity','0.40');
}
function applyWm(){
  const on = ADMIN ? (wmToggle?.checked ?? true) : true;
  const v = ADMIN ? ((parseInt(wmRange?.value||'40',10)||0)/100) : 0.40;
  document.documentElement.style.setProperty('--wmOpacity',String(v));
  if(ADMIN && wmVal) wmVal.textContent=(v*100).toFixed(0)+'%';
  $$('.thumb a[data-src]').forEach(a=>{ if(on) a.setAttribute('data-wm',WM_TEXT); else a.removeAttribute('data-wm'); });
  const lbWm=$('#lb-wm'); if(lbWm){ lbWm.style.display=on?'flex':'none'; lbWm.textContent=WM_TEXT; }
}
if(ADMIN){
  wmToggle?.addEventListener('change',applyWm);
  wmRange?.addEventListener('input',applyWm);
  applyWm();
}else{
  forceVisitorWM();
}

/* --------- Masks: presets + persistência + catálogo --------- */
const PRESETS={"tr-compact":"82,2,16,12","tr-wide":"74,2,24,14","header-bar":"0,0,100,10","footer-bar":"0,88,100,12","bl-compact":"2,84,20,12","br-compact":"78,84,20,12"};

async function loadMasksCatalog() {
  try {
    const res = await fetch('masks.json', { cache: 'no-store' });
    if (!res.ok) return;
    const catalog = await res.json(); // { "img/arquivo.png": "l,t,w,h; ..." }
    document.querySelectorAll('.thumb a[data-src]').forEach(a=>{
      const key = a.getAttribute('data-src');
      if (key && catalog[key]) {
        a.dataset.mask = catalog[key];
        try { localStorage.setItem('masks::'+key, catalog[key]); } catch(_) {}
      }
    });
  } catch(_) {}
}

const LS_PREFIX='masks::';
function maskKeyForAnchor(a){
  const src = a.getAttribute('data-src') || a.querySelector('img')?.getAttribute('src') || '';
  return LS_PREFIX + src;
}
function loadMasksFromStorage(a){
  try{ return localStorage.getItem(maskKeyForAnchor(a)) || ''; }catch(_){ return ''; }
}
function saveMasksToStorage(a, value){
  try{ localStorage.setItem(maskKeyForAnchor(a), value||''); }catch(_){}
}

function parseMasks(el){
  const ms=[];
  const p=el.dataset.maskPreset; if(p&&PRESETS[p]) ms.push(PRESETS[p]);
  const fromHtml=(el.dataset.mask||'').split(';').map(s=>s.trim()).filter(Boolean);
  ms.push(...fromHtml);
  const fromLs=(loadMasksFromStorage(el)||'').split(';').map(s=>s.trim()).filter(Boolean);
  if(fromLs.length) return fromLs;
  return ms;
}

function refreshThumbMasks(a){
  a.querySelectorAll('.mask').forEach(m=>m.remove());
  const defs=parseMasks(a);
  defs.forEach(def=>{
    const [l,t,w,h]=def.split(',').map(Number);
    if([l,t,w,h].some(n=>isNaN(n)))return;
    const m=document.createElement('span');
    m.className='mask';
    m.style.left=l+'%'; m.style.top=t+'%'; m.style.width=w+'%'; m.style.height=h+'%';
    a.appendChild(m);
  });
}

/* Ajuste thumbs + watermark + catálogo */
window.addEventListener('load', async ()=>{
  await loadMasksCatalog();
  document.querySelectorAll('.thumb a[data-src]').forEach(a=>{
    const img = a.querySelector('img'); if(!img) return;
    const sync=()=>{ a.style.width=img.clientWidth+'px'; a.style.height=img.clientHeight+'px'; };
    if(img.complete) sync(); else img.addEventListener('load',sync);
    a.setAttribute('data-wm',WM_TEXT);
    refreshThumbMasks(a);
  });
});

/* --------- Lightbox + edição (somente ADMIN) --------- */
const lb=$('#lightbox'), lbFig=$('#lb-fig'), lbImg=$('#lb-img'), lbMasksBox=$('#lb-masks'), lbWm=$('#lb-wm');
const lbTitle=$('#lb-title'), lbDesc=$('#lb-desc'), closeBtn=$('.close',lb);
const btnEdit=$('#lb-edit-toggle'), btnAdd=$('#lb-add'), btnUndo=$('#lb-undo'), btnClear=$('#lb-clear'), btnCopy=$('#lb-copy');
const btnExport=$('#lb-export'), inpImport=$('#lb-import');
const zoomRange=$('#lb-zoom'), zoomVal=$('#lb-zoom-val');

let lastAnchor=null, masksArr=[], editing=false, adding=false, sel=null, startX=0,startY=0; let natW=0,natH=0;

function setMasksPointer(on){ lbMasksBox.style.pointerEvents=(ADMIN&&on)?'auto':'none'; }
function clearLbMasks(){ lbMasksBox.innerHTML=''; }
function renderLbMasks(){
  clearLbMasks();
  masksArr.forEach((def,idx)=>{
    const [l,t,w,h]=def.split(',').map(Number);
    const m=document.createElement('span');
    m.className='mask'; m.dataset.idx=idx;
    m.style.left=l+'%'; m.style.top=t+'%'; m.style.width=w+'%'; m.style.height=h+'%';
    lbMasksBox.appendChild(m);
  });
}
function persistMasks(){
  if(!lastAnchor) return;
  const flat = masksArr.join('; ');
  lastAnchor.dataset.mask = flat;
  saveMasksToStorage(lastAnchor, flat);
  refreshThumbMasks(lastAnchor);
}
function setZoom(v){
  zoomRange.value=v; zoomVal.textContent=v+'%';
  if(natW>0){ lbFig.style.width=(natW*v/100)+'px'; lbFig.style.height=(natH*v/100)+'px'; }
}

function openLB(a){
  lastAnchor=a;
  lbImg.onload=()=>{
    natW=lbImg.naturalWidth||lbImg.width; natH=lbImg.naturalHeight||lbImg.height;
    setZoom(100);
    masksArr=parseMasks(a);
    renderLbMasks();
    lbWm.style.display='flex';
    lbWm.textContent=WM_TEXT;
    setMasksPointer(false);
  };
  lbImg.src=a.dataset.src;
  lbTitle.textContent=a.dataset.title||'';
  lbDesc.textContent=a.dataset.desc||'';
  lb.classList.add('open');

  window.track && window.track('open_image');

  closeBtn.focus();
}

function closeLB(){
  persistMasks();
  lb.classList.remove('open');
  lbImg.src=''; lbTitle.textContent=''; lbDesc.textContent='';
  clearLbMasks(); stopAdd(); editing=false;
  if(btnEdit) btnEdit.textContent='Editar máscaras';
  setMasksPointer(false);
}

document.addEventListener('click',(e)=>{
  const a=e.target.closest('a[data-src]');
  if(a){ e.preventDefault(); openLB(a); }
  if(e.target===lb){ closeLB(); }
});
closeBtn.addEventListener('click',closeLB);
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape') closeLB(); });

/* Zoom */
zoomRange?.addEventListener('input',e=> setZoom(parseInt(e.target.value,10)));

/* ---- Edição: apenas ADMIN ---- */
function toggleEdit(){ if(!ADMIN) return; editing=!editing; if(btnEdit) btnEdit.textContent=editing?'Editar máscaras (Ligado)':'Editar máscaras'; setMasksPointer(editing); }
function startAdd(){ if(!ADMIN) return; if(!editing) toggleEdit(); adding=true; if(btnAdd) btnAdd.textContent='+ Adicionando…'; lbFig.style.cursor='crosshair'; }
function stopAdd(){ adding=false; if(btnAdd) btnAdd.textContent='+ Adicionar'; lbFig.style.cursor='auto'; if(sel){ sel.remove(); sel=null; } }
function pct(x,t){ return Math.max(0,Math.min(100,x/t*100)); }

lbFig.addEventListener('mousedown',(e)=>{
  if(!ADMIN || !adding) return;
  const r=lbFig.getBoundingClientRect(); startX=e.clientX-r.left; startY=e.clientY-r.top;
  sel=document.createElement('span'); sel.className='sel-rect'; sel.style.left=startX+'px'; sel.style.top=startY+'px';
  lbFig.appendChild(sel); e.preventDefault();
});
lbFig.addEventListener('mousemove',(e)=>{
  if(!ADMIN || !adding || !sel) return;
  const r=lbFig.getBoundingClientRect(); const cx=e.clientX-r.left, cy=e.clientY-r.top;
  const x=Math.min(cx,startX), y=Math.min(cy,startY), w=Math.abs(cx-startX), h=Math.abs(cy-startY);
  sel.style.left=x+'px'; sel.style.top=y+'px'; sel.style.width=w+'px'; sel.style.height=h+'px';
});
lbFig.addEventListener('mouseup',()=>{
  if(!ADMIN || !adding || !sel) return;
  const r=lbFig.getBoundingClientRect();
  const x=parseFloat(sel.style.left), y=parseFloat(sel.style.top);
  const w=parseFloat(sel.style.width), h=parseFloat(sel.style.height);
  const out=[pct(x,r.width).toFixed(0), pct(y,r.height).toFixed(0), pct(w,r.width).toFixed(0), pct(h,r.height).toFixed(0)].join(',');
  masksArr.push(out); renderLbMasks(); persistMasks(); sel.remove(); sel=null; stopAdd();
});
lbMasksBox.addEventListener('click',(e)=>{
  if(!ADMIN || !editing || !e.ctrlKey) return;
  const m=e.target.closest('.mask'); if(!m) return;
  const idx=parseInt(m.dataset.idx,10);
  if(!Number.isNaN(idx)){ masksArr.splice(idx,1); renderLbMasks(); persistMasks(); }
});

if(ADMIN){
  btnEdit?.addEventListener('click',toggleEdit);
  btnAdd?.addEventListener('click',startAdd);
  btnUndo?.addEventListener('click',()=>{ if(masksArr.length){ masksArr.pop(); renderLbMasks(); persistMasks(); }});
  btnClear?.addEventListener('click',()=>{ masksArr=[]; renderLbMasks(); persistMasks(); });
  btnCopy?.addEventListener('click',()=>{
    const val=masksArr.join('; ');
    if(navigator.clipboard){ navigator.clipboard.writeText(val).catch(()=>{}); }
    btnCopy.textContent='📋 Copiado!'; setTimeout(()=>btnCopy.textContent='📋 Copiar máscaras',900);
  });

  /* Exportar/Importar TODAS as máscaras */
  btnExport?.addEventListener('click',()=>{
    const data={};
    $$('.thumb a[data-src]').forEach(a=>{
      const key=(a.getAttribute('data-src')||'').trim();
      if(!key) return;
      const fromLs = loadMasksFromStorage(a);
      const val = fromLs || (a.dataset.mask||'');
      if(val) data[key]=val;
    });
    const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const link=document.createElement('a'); link.href=url; link.download='masks.json';
    document.body.appendChild(link); link.click(); link.remove(); URL.revokeObjectURL(url);
    window.track && window.track('export_masks');
  });

  inpImport?.addEventListener('change',(e)=>{
    const file=e.target.files?.[0]; if(!file) return;
    const reader=new FileReader();
    reader.onload=()=>{
      try{
        const obj=JSON.parse(reader.result);
        $$('.thumb a[data-src]').forEach(a=>{
          const k=a.getAttribute('data-src');
          if(k && obj[k]){
            a.dataset.mask=obj[k];
            saveMasksToStorage(a, obj[k]);
            refreshThumbMasks(a);
          }
        });
        alert('Máscaras importadas e aplicadas.');
        window.track && window.track('import_masks');
      }catch(_){ alert('Arquivo inválido.'); }
    };
    reader.readAsText(file);
  });
}
</script>
</body>
</html>
